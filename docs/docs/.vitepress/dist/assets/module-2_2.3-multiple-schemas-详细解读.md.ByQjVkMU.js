import{_ as a,c as i,o as n,ag as l}from"./chunks/framework.Cf3FQAeg.js";const c=JSON.parse('{"title":"LangGraph Multiple Schemas è¯¦ç»†è§£è¯»","description":"","frontmatter":{},"headers":[],"relativePath":"module-2/2.3-multiple-schemas-è¯¦ç»†è§£è¯».md","filePath":"module-2/2.3-multiple-schemas-è¯¦ç»†è§£è¯».md","lastUpdated":1760223716000}'),p={name:"module-2/2.3-multiple-schemas-è¯¦ç»†è§£è¯».md"};function e(t,s,h,k,r,d){return n(),i("div",null,[...s[0]||(s[0]=[l(`<h1 id="langgraph-multiple-schemas-è¯¦ç»†è§£è¯»" tabindex="-1">LangGraph Multiple Schemas è¯¦ç»†è§£è¯» <a class="header-anchor" href="#langgraph-multiple-schemas-è¯¦ç»†è§£è¯»" aria-label="Permalink to &quot;LangGraph Multiple Schemas è¯¦ç»†è§£è¯»&quot;">â€‹</a></h1><h2 id="ğŸ“š-æ¦‚è¿°" tabindex="-1">ğŸ“š æ¦‚è¿° <a class="header-anchor" href="#ğŸ“š-æ¦‚è¿°" aria-label="Permalink to &quot;ğŸ“š æ¦‚è¿°&quot;">â€‹</a></h2><p>æœ¬æ–‡æ¡£è¯¦ç»†è§£è¯» LangGraph ä¸­çš„ <strong>Multiple Schemasï¼ˆå¤šçŠ¶æ€æ¨¡å¼ï¼‰</strong> æ¦‚å¿µã€‚è¿™æ˜¯ä¸€ç§é«˜çº§çŠ¶æ€ç®¡ç†æŠ€æœ¯ï¼Œå…è®¸æˆ‘ä»¬åœ¨å›¾çš„ä¸åŒéƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„çŠ¶æ€ç»“æ„ï¼Œä»è€Œå®ç°æ›´çµæ´»ã€æ›´å®‰å…¨ã€æ›´æ¸…æ™°çš„çŠ¶æ€ç®¡ç†ã€‚</p><h2 id="ğŸ¯-æ ¸å¿ƒæ¦‚å¿µ" tabindex="-1">ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ <a class="header-anchor" href="#ğŸ¯-æ ¸å¿ƒæ¦‚å¿µ" aria-label="Permalink to &quot;ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ&quot;">â€‹</a></h2><h3 id="ä»€ä¹ˆæ˜¯-multiple-schemas" tabindex="-1">ä»€ä¹ˆæ˜¯ Multiple Schemasï¼Ÿ <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-multiple-schemas" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯ Multiple Schemasï¼Ÿ&quot;">â€‹</a></h3><p>åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨<strong>å•ä¸€çŠ¶æ€æ¨¡å¼</strong>ï¼šæ•´ä¸ªå›¾çš„æ‰€æœ‰èŠ‚ç‚¹å…±äº«åŒä¸€ä¸ªçŠ¶æ€ç»“æ„ï¼ˆSchemaï¼‰ã€‚ä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿™ç§æ–¹å¼æœ‰æ—¶ä¼šå¸¦æ¥é—®é¢˜ï¼š</p><p><strong>å•ä¸€çŠ¶æ€çš„é—®é¢˜ï¼š</strong></p><ol><li><strong>çŠ¶æ€æ±¡æŸ“</strong>ï¼šå†…éƒ¨èŠ‚ç‚¹å¯èƒ½äº§ç”Ÿä¸­é—´æ•°æ®ï¼Œä½†è¿™äº›æ•°æ®ä¸åº”è¯¥æš´éœ²ç»™ç”¨æˆ·</li><li><strong>è¾“å…¥è¾“å‡ºä¸çµæ´»</strong>ï¼šç”¨æˆ·å¯èƒ½åªéœ€è¦æä¾›éƒ¨åˆ†è¾“å…¥ï¼Œæˆ–åªéœ€è¦éƒ¨åˆ†è¾“å‡º</li><li><strong>èŠ‚ç‚¹è€¦åˆ</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¾èµ–åŒä¸€ä¸ªåºå¤§çš„çŠ¶æ€ç»“æ„ï¼Œå¢åŠ å¤æ‚åº¦</li></ol><p><strong>Multiple Schemas çš„è§£å†³æ–¹æ¡ˆï¼š</strong></p><ol><li><strong>Private Stateï¼ˆç§æœ‰çŠ¶æ€ï¼‰</strong>ï¼šèŠ‚ç‚¹é—´å¯ä»¥ä¼ é€’ç§æœ‰æ•°æ®ï¼Œä¸æš´éœ²ç»™å¤–éƒ¨</li><li><strong>Input Schemaï¼ˆè¾“å…¥æ¨¡å¼ï¼‰</strong>ï¼šé™å®šç”¨æˆ·è¾“å…¥çš„å­—æ®µ</li><li><strong>Output Schemaï¼ˆè¾“å‡ºæ¨¡å¼ï¼‰</strong>ï¼šé™å®šè¿”å›ç»™ç”¨æˆ·çš„å­—æ®µ</li><li><strong>Internal Stateï¼ˆå†…éƒ¨çŠ¶æ€ï¼‰</strong>ï¼šå›¾å†…éƒ¨ä½¿ç”¨çš„å®Œæ•´çŠ¶æ€</li></ol><hr><h2 id="ğŸ­-å®æˆ˜æ¡ˆä¾‹-1-ç§æœ‰çŠ¶æ€-private-state" tabindex="-1">ğŸ­ å®æˆ˜æ¡ˆä¾‹ 1ï¼šç§æœ‰çŠ¶æ€ï¼ˆPrivate Stateï¼‰ <a class="header-anchor" href="#ğŸ­-å®æˆ˜æ¡ˆä¾‹-1-ç§æœ‰çŠ¶æ€-private-state" aria-label="Permalink to &quot;ğŸ­ å®æˆ˜æ¡ˆä¾‹ 1ï¼šç§æœ‰çŠ¶æ€ï¼ˆPrivate Stateï¼‰&quot;">â€‹</a></h2><h3 id="éœ€æ±‚åœºæ™¯" tabindex="-1">éœ€æ±‚åœºæ™¯ <a class="header-anchor" href="#éœ€æ±‚åœºæ™¯" aria-label="Permalink to &quot;éœ€æ±‚åœºæ™¯&quot;">â€‹</a></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè®¡ç®—æµç¨‹ï¼š</p><ol><li><code>node_1</code> æ¥æ”¶ç”¨æˆ·è¾“å…¥ <code>foo</code>ï¼Œè®¡ç®—å‡ºä¸­é—´ç»“æœ <code>baz</code></li><li><code>node_2</code> ä½¿ç”¨ <code>baz</code> è¿›è¡Œè¿›ä¸€æ­¥è®¡ç®—ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœ <code>foo</code></li><li><strong>å…³é”®</strong>ï¼š<code>baz</code> æ˜¯ä¸­é—´è®¡ç®—å€¼ï¼Œä¸åº”è¯¥æš´éœ²ç»™ç”¨æˆ·</li></ol><h3 id="ç³»ç»Ÿæ¶æ„å›¾" tabindex="-1">ç³»ç»Ÿæ¶æ„å›¾ <a class="header-anchor" href="#ç³»ç»Ÿæ¶æ„å›¾" aria-label="Permalink to &quot;ç³»ç»Ÿæ¶æ„å›¾&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·è¾“å…¥: {foo: 1}</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>   [node_1]</span></span>
<span class="line"><span>   è¾“å…¥: OverallState {foo: 1}</span></span>
<span class="line"><span>   è®¡ç®—: baz = foo + 1 = 2</span></span>
<span class="line"><span>   è¾“å‡º: PrivateState {baz: 2}</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>   [node_2]</span></span>
<span class="line"><span>   è¾“å…¥: PrivateState {baz: 2}</span></span>
<span class="line"><span>   è®¡ç®—: foo = baz + 1 = 3</span></span>
<span class="line"><span>   è¾“å‡º: OverallState {foo: 3}</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>ç”¨æˆ·è¾“å‡º: {foo: 3}  â† baz è¢«éšè—äº†ï¼</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr><h2 id="ğŸ”§-ä»£ç å®ç°è¯¦è§£-ç§æœ‰çŠ¶æ€" tabindex="-1">ğŸ”§ ä»£ç å®ç°è¯¦è§£ï¼šç§æœ‰çŠ¶æ€ <a class="header-anchor" href="#ğŸ”§-ä»£ç å®ç°è¯¦è§£-ç§æœ‰çŠ¶æ€" aria-label="Permalink to &quot;ğŸ”§ ä»£ç å®ç°è¯¦è§£ï¼šç§æœ‰çŠ¶æ€&quot;">â€‹</a></h2><h3 id="_1-å®šä¹‰çŠ¶æ€" tabindex="-1">1. å®šä¹‰çŠ¶æ€ <a class="header-anchor" href="#_1-å®šä¹‰çŠ¶æ€" aria-label="Permalink to &quot;1. å®šä¹‰çŠ¶æ€&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing_extensions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TypedDict</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…¨å±€çŠ¶æ€ï¼ˆå¯¹å¤–å¯è§ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    foo: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç§æœ‰çŠ¶æ€ï¼ˆå†…éƒ¨ä½¿ç”¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrivateState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    baz: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>è®¾è®¡æ€è·¯ï¼š</strong></p><ul><li><code>OverallState</code>ï¼šå›¾çš„è¾“å…¥å’Œè¾“å‡ºçŠ¶æ€ï¼Œç”¨æˆ·å¯è§</li><li><code>PrivateState</code>ï¼šå†…éƒ¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’çš„ç§æœ‰æ•°æ®</li><li>ä¸¤è€…å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°</li></ul><hr><h3 id="_2-å®šä¹‰èŠ‚ç‚¹" tabindex="-1">2. å®šä¹‰èŠ‚ç‚¹ <a class="header-anchor" href="#_2-å®šä¹‰èŠ‚ç‚¹" aria-label="Permalink to &quot;2. å®šä¹‰èŠ‚ç‚¹&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node_1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState) -&gt; PrivateState:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;---Node 1---&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;baz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;foo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node_2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; OverallState:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;---Node 2---&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;baz&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>å…³é”®ç‚¹è§£æï¼š</strong></p><h4 id="node-1-çš„ç±»å‹ç­¾å" tabindex="-1">node_1 çš„ç±»å‹ç­¾å <a class="header-anchor" href="#node-1-çš„ç±»å‹ç­¾å" aria-label="Permalink to &quot;node_1 çš„ç±»å‹ç­¾å&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node_1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState) -&gt; PrivateState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ^^^^^^^^^^^^^^^^    ^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         è¾“å…¥ç±»å‹              è¾“å‡ºç±»å‹</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>è¾“å…¥</strong>ï¼š<code>OverallState</code> - ä»ç”¨æˆ·è¾“å…¥æˆ–å›¾çŠ¶æ€è¯»å– <code>foo</code></li><li><strong>è¾“å‡º</strong>ï¼š<code>PrivateState</code> - è¿”å›ç§æœ‰å­—æ®µ <code>baz</code></li><li><strong>é‡è¦</strong>ï¼šè™½ç„¶è¿”å›ç±»å‹æ˜¯ <code>PrivateState</code>ï¼Œä½†è¿”å›çš„æ•°æ®ä¼šè¢«åˆå¹¶åˆ°å›¾çš„æ€»ä½“çŠ¶æ€ä¸­</li></ul><h4 id="node-2-çš„ç±»å‹ç­¾å" tabindex="-1">node_2 çš„ç±»å‹ç­¾å <a class="header-anchor" href="#node-2-çš„ç±»å‹ç­¾å" aria-label="Permalink to &quot;node_2 çš„ç±»å‹ç­¾å&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node_2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; OverallState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ^^^^^^^^^^^^^^^    ^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ä»ç§æœ‰çŠ¶æ€è¯»å–       å†™å›å…¨å±€çŠ¶æ€</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>è¾“å…¥</strong>ï¼š<code>PrivateState</code> - è¯»å– <code>node_1</code> äº§ç”Ÿçš„ç§æœ‰å­—æ®µ <code>baz</code></li><li><strong>è¾“å‡º</strong>ï¼š<code>OverallState</code> - æ›´æ–°å…¬å¼€å­—æ®µ <code>foo</code></li></ul><p><strong>Python çŸ¥è¯†ç‚¹ï¼šç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰</strong></p><p>Python çš„ç±»å‹æ³¨è§£ç”¨äºï¼š</p><ol><li><strong>é™æ€ç±»å‹æ£€æŸ¥</strong>ï¼šå¸®åŠ© IDE å’Œå·¥å…·æ£€æµ‹ç±»å‹é”™è¯¯</li><li><strong>æ–‡æ¡£ä½œç”¨</strong>ï¼šæ¸…æ™°è¡¨è¾¾å‡½æ•°çš„è¾“å…¥è¾“å‡º</li><li><strong>LangGraph ä½¿ç”¨</strong>ï¼šå‘Šè¯‰ LangGraph èŠ‚ç‚¹ä½¿ç”¨å“ªä¸ªçŠ¶æ€ç»“æ„</li></ol><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç±»å‹æ³¨è§£è¯­æ³•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(param: InputType) -&gt; OutputType:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> value</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># LangGraph ä¸­çš„ç‰¹æ®Šç”¨é€”</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># LangGraph ä¼šæ ¹æ®ç±»å‹æ³¨è§£è‡ªåŠ¨è¿›è¡ŒçŠ¶æ€è¿‡æ»¤å’Œæ˜ å°„</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; OverallState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # LangGraph è‡ªåŠ¨ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. ä»æ€»çŠ¶æ€ä¸­æå– PrivateState å­—æ®µä¼ ç»™ node</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. å°† node è¿”å›çš„ OverallState å­—æ®µåˆå¹¶å›æ€»çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><hr><h3 id="_3-æ„å»ºå›¾" tabindex="-1">3. æ„å»ºå›¾ <a class="header-anchor" href="#_3-æ„å»ºå›¾" aria-label="Permalink to &quot;3. æ„å»ºå›¾&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> langgraph.graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">START</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">END</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ OverallState ä½œä¸ºå›¾çš„ä¸»çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(OverallState)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, node_1)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, node_2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ·»åŠ è¾¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder.add_edge(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">START</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder.add_edge(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">builder.add_edge(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;node_2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç¼–è¯‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> builder.compile()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>LangGraph çŸ¥è¯†ç‚¹ï¼šçŠ¶æ€å›¾åˆå§‹åŒ–</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StateGraph(OverallState)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#          ^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#          å›¾çš„ä¸»çŠ¶æ€ç±»å‹</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>å°½ç®¡èŠ‚ç‚¹å¯èƒ½ä½¿ç”¨ä¸åŒçš„çŠ¶æ€ç±»å‹ï¼ˆå¦‚ <code>PrivateState</code>ï¼‰ï¼Œä½†å›¾æœ¬èº«æœ‰ä¸€ä¸ªä¸»çŠ¶æ€ç±»å‹</li><li>è¿™ä¸ªä¸»çŠ¶æ€ç±»å‹å®šä¹‰äº†å›¾çš„è¾“å…¥å’Œè¾“å‡ºæ¥å£</li><li>èŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºç±»å‹å¯ä»¥æ˜¯ä¸»çŠ¶æ€çš„å­é›†æˆ–è¶…é›†</li></ul><hr><h3 id="_4-æ‰§è¡Œä¸è§‚å¯Ÿ" tabindex="-1">4. æ‰§è¡Œä¸è§‚å¯Ÿ <a class="header-anchor" href="#_4-æ‰§è¡Œä¸è§‚å¯Ÿ" aria-label="Permalink to &quot;4. æ‰§è¡Œä¸è§‚å¯Ÿ&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡º: {&#39;foo&#39;: 3}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>æ‰§è¡Œæµç¨‹è¯¦è§£ï¼š</strong></p><table tabindex="0"><thead><tr><th>æ­¥éª¤</th><th>å½“å‰çŠ¶æ€</th><th>èŠ‚ç‚¹</th><th>è¾“å…¥</th><th>è¾“å‡º</th><th>çŠ¶æ€æ›´æ–°å</th></tr></thead><tbody><tr><td>1</td><td><code>{foo: 1}</code></td><td>node_1</td><td><code>{foo: 1}</code></td><td><code>{baz: 2}</code></td><td><code>{foo: 1, baz: 2}</code></td></tr><tr><td>2</td><td><code>{foo: 1, baz: 2}</code></td><td>node_2</td><td><code>{baz: 2}</code></td><td><code>{foo: 3}</code></td><td><code>{foo: 3, baz: 2}</code></td></tr><tr><td>3</td><td>æœ€ç»ˆè¾“å‡ºè¿‡æ»¤</td><td>-</td><td>-</td><td>-</td><td><code>{foo: 3}</code> â† <code>baz</code> è¢«è¿‡æ»¤æ‰</td></tr></tbody></table><p><strong>å…³é”®è§‚å¯Ÿï¼š</strong></p><ol><li><code>baz</code> åœ¨å›¾çš„å†…éƒ¨çŠ¶æ€ä¸­å­˜åœ¨ï¼ˆæ­¥éª¤ 1-2ï¼‰</li><li>ä½†æœ€ç»ˆè¾“å‡ºæ—¶ï¼Œåªè¿”å› <code>OverallState</code> ä¸­å®šä¹‰çš„å­—æ®µï¼ˆ<code>foo</code>ï¼‰</li><li><code>baz</code> æˆåŠŸéšè—ï¼Œå®ç°äº†ç§æœ‰çŠ¶æ€çš„æ•ˆæœ</li></ol><hr><h2 id="ğŸ­-å®æˆ˜æ¡ˆä¾‹-2-è¾“å…¥-è¾“å‡ºæ¨¡å¼-input-output-schema" tabindex="-1">ğŸ­ å®æˆ˜æ¡ˆä¾‹ 2ï¼šè¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼ˆInput/Output Schemaï¼‰ <a class="header-anchor" href="#ğŸ­-å®æˆ˜æ¡ˆä¾‹-2-è¾“å…¥-è¾“å‡ºæ¨¡å¼-input-output-schema" aria-label="Permalink to &quot;ğŸ­ å®æˆ˜æ¡ˆä¾‹ 2ï¼šè¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼ˆInput/Output Schemaï¼‰&quot;">â€‹</a></h2><h3 id="éœ€æ±‚åœºæ™¯-1" tabindex="-1">éœ€æ±‚åœºæ™¯ <a class="header-anchor" href="#éœ€æ±‚åœºæ™¯-1" aria-label="Permalink to &quot;éœ€æ±‚åœºæ™¯&quot;">â€‹</a></h3><p>æ„å»ºä¸€ä¸ªé—®ç­”ç³»ç»Ÿï¼š</p><ol><li><strong>ç”¨æˆ·è¾“å…¥</strong>ï¼šåªéœ€è¦æä¾› <code>question</code></li><li><strong>å†…éƒ¨å¤„ç†</strong>ï¼šç”Ÿæˆ <code>answer</code> å’Œ <code>notes</code>ï¼ˆå†…éƒ¨æ€è€ƒè¿‡ç¨‹ï¼‰</li><li><strong>ç”¨æˆ·è¾“å‡º</strong>ï¼šåªè¿”å› <code>answer</code>ï¼Œéšè— <code>notes</code></li></ol><h3 id="ç³»ç»Ÿæ¶æ„å›¾-1" tabindex="-1">ç³»ç»Ÿæ¶æ„å›¾ <a class="header-anchor" href="#ç³»ç»Ÿæ¶æ„å›¾-1" aria-label="Permalink to &quot;ç³»ç»Ÿæ¶æ„å›¾&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ç”¨æˆ·è¾“å…¥: {question: &quot;hi&quot;}  â† ç¬¦åˆ InputState</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>   [thinking_node]</span></span>
<span class="line"><span>   ç”Ÿæˆ: answer=&quot;bye&quot;, notes=&quot;... his name is Lance&quot;</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>   [answer_node]</span></span>
<span class="line"><span>   ç”Ÿæˆ: answer=&quot;bye Lance&quot;</span></span>
<span class="line"><span>      â†“</span></span>
<span class="line"><span>ç”¨æˆ·è¾“å‡º: {answer: &quot;bye Lance&quot;}  â† ç¬¦åˆ OutputStateï¼Œnotes è¢«éšè—</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr><h2 id="ğŸ”§-ä»£ç å®ç°è¯¦è§£-è¾“å…¥-è¾“å‡ºæ¨¡å¼" tabindex="-1">ğŸ”§ ä»£ç å®ç°è¯¦è§£ï¼šè¾“å…¥/è¾“å‡ºæ¨¡å¼ <a class="header-anchor" href="#ğŸ”§-ä»£ç å®ç°è¯¦è§£-è¾“å…¥-è¾“å‡ºæ¨¡å¼" aria-label="Permalink to &quot;ğŸ”§ ä»£ç å®ç°è¯¦è§£ï¼šè¾“å…¥/è¾“å‡ºæ¨¡å¼&quot;">â€‹</a></h2><h3 id="_1-å®šä¹‰ä¸‰ç§çŠ¶æ€" tabindex="-1">1. å®šä¹‰ä¸‰ç§çŠ¶æ€ <a class="header-anchor" href="#_1-å®šä¹‰ä¸‰ç§çŠ¶æ€" aria-label="Permalink to &quot;1. å®šä¹‰ä¸‰ç§çŠ¶æ€&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing_extensions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TypedDict</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å…¥çŠ¶æ€ï¼šç”¨æˆ·å¿…é¡»æä¾›çš„å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡ºçŠ¶æ€ï¼šè¿”å›ç»™ç”¨æˆ·çš„å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†…éƒ¨çŠ¶æ€ï¼šå›¾å†…éƒ¨ä½¿ç”¨çš„å®Œæ•´çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    notes: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>è®¾è®¡æ¨¡å¼ï¼šçŠ¶æ€åˆ†å±‚</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>InputState (æœ€å°è¾“å…¥)</span></span>
<span class="line"><span>    â†“ åŒ…å«äº</span></span>
<span class="line"><span>OverallState (å®Œæ•´å†…éƒ¨çŠ¶æ€)</span></span>
<span class="line"><span>    â†“ è¿‡æ»¤ä¸º</span></span>
<span class="line"><span>OutputState (æœ€å°è¾“å‡º)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Python çŸ¥è¯†ç‚¹ï¼šTypedDict ç»§æ‰¿å…³ç³»</strong></p><p>è™½ç„¶è¿™é‡Œæ²¡æœ‰ä½¿ç”¨ç»§æ‰¿ï¼Œä½† TypedDict æ”¯æŒç»§æ‰¿ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ–¹å¼ 1ï¼šç‹¬ç«‹å®šä¹‰ï¼ˆå¦‚ä¸Šé¢ä»£ç ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ–¹å¼ 2ï¼šç»§æ‰¿æ‰©å±•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç»§æ‰¿ InputState</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    notes: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸¤ç§æ–¹å¼æ•ˆæœç±»ä¼¼ï¼Œä½†ç»§æ‰¿æ–¹å¼ç¡®ä¿å­—æ®µä¸€è‡´æ€§</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr><h3 id="_2-å®šä¹‰èŠ‚ç‚¹-ç‰ˆæœ¬-1-ä¸ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼" tabindex="-1">2. å®šä¹‰èŠ‚ç‚¹ï¼ˆç‰ˆæœ¬ 1ï¼šä¸ä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼‰ <a class="header-anchor" href="#_2-å®šä¹‰èŠ‚ç‚¹-ç‰ˆæœ¬-1-ä¸ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼" aria-label="Permalink to &quot;2. å®šä¹‰èŠ‚ç‚¹ï¼ˆç‰ˆæœ¬ 1ï¼šä¸ä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼‰&quot;">â€‹</a></h3><p>å…ˆçœ‹æ²¡æœ‰ Input/Output Schema çš„ç‰ˆæœ¬ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    notes: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> thinking_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;notes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;... his name is Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> answer_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ„å»ºå›¾</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(OverallState)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, answer_node)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, thinking_node)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">START</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(answer_node, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.compile()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡º: {&#39;question&#39;: &#39;hi&#39;, &#39;answer&#39;: &#39;bye Lance&#39;, &#39;notes&#39;: &#39;... his name is Lance&#39;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>é—®é¢˜ï¼š</strong> æ‰€æœ‰å†…éƒ¨å­—æ®µï¼ˆåŒ…æ‹¬ <code>notes</code>ï¼‰éƒ½æš´éœ²ç»™ç”¨æˆ·äº†ï¼</p><hr><h3 id="_3-å®šä¹‰èŠ‚ç‚¹-ç‰ˆæœ¬-2-ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼-âœ…" tabindex="-1">3. å®šä¹‰èŠ‚ç‚¹ï¼ˆç‰ˆæœ¬ 2ï¼šä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼‰âœ… <a class="header-anchor" href="#_3-å®šä¹‰èŠ‚ç‚¹-ç‰ˆæœ¬-2-ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼-âœ…" aria-label="Permalink to &quot;3. å®šä¹‰èŠ‚ç‚¹ï¼ˆç‰ˆæœ¬ 2ï¼šä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼‰âœ…&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    notes: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŠ‚ç‚¹ 1ï¼šåªéœ€è¦ InputState</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> thinking_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InputState):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;notes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;... his name is Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŠ‚ç‚¹ 2ï¼šä½¿ç”¨ OverallStateï¼Œä½†å£°æ˜è¾“å‡ºä¸º OutputState</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> answer_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState) -&gt; OutputState:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ„å»ºå›¾ï¼šæŒ‡å®šè¾“å…¥å’Œè¾“å‡ºæ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    OverallState,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    input_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InputState,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é™å®šè¾“å…¥</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    output_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OutputState   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é™å®šè¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, answer_node)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_node(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, thinking_node)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">START</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;thinking_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer_node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.add_edge(answer_node, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.compile()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡º: {&#39;answer&#39;: &#39;bye Lance&#39;}  â† notes è¢«è¿‡æ»¤æ‰äº†ï¼</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p><strong>å…³é”®æ”¹è¿›ï¼š</strong></p><ol><li><code>StateGraph</code> æ„é€ æ—¶æŒ‡å®š <code>input_schema</code> å’Œ <code>output_schema</code></li><li><code>thinking_node</code> çš„è¾“å…¥ç±»å‹æ³¨è§£ä¸º <code>InputState</code></li><li><code>answer_node</code> çš„è¾“å‡ºç±»å‹æ³¨è§£ä¸º <code>OutputState</code></li></ol><hr><h3 id="_4-ç±»å‹æ³¨è§£çš„ä½œç”¨" tabindex="-1">4. ç±»å‹æ³¨è§£çš„ä½œç”¨ <a class="header-anchor" href="#_4-ç±»å‹æ³¨è§£çš„ä½œç”¨" aria-label="Permalink to &quot;4. ç±»å‹æ³¨è§£çš„ä½œç”¨&quot;">â€‹</a></h3><h4 id="thinking-node-çš„ç±»å‹æ³¨è§£" tabindex="-1">thinking_node çš„ç±»å‹æ³¨è§£ <a class="header-anchor" href="#thinking-node-çš„ç±»å‹æ³¨è§£" aria-label="Permalink to &quot;thinking_node çš„ç±»å‹æ³¨è§£&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> thinking_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InputState):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #                 ^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #                 åªèƒ½è®¿é—® question å­—æ®µ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;notes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;... his name is Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>ä½œç”¨ï¼š</strong></p><ul><li><strong>è¾“å…¥è¿‡æ»¤</strong>ï¼šLangGraph åªä¼ é€’ <code>InputState</code> ä¸­å®šä¹‰çš„å­—æ®µï¼ˆ<code>question</code>ï¼‰</li><li><strong>å®‰å…¨æ€§</strong>ï¼šèŠ‚ç‚¹æ— æ³•æ„å¤–è®¿é—®å…¶ä»–å­—æ®µ</li><li><strong>æ¸…æ™°æ€§</strong>ï¼šæ˜ç¡®è¡¨è¾¾èŠ‚ç‚¹çš„è¾“å…¥ä¾èµ–</li></ul><h4 id="answer-node-çš„ç±»å‹æ³¨è§£" tabindex="-1">answer_node çš„ç±»å‹æ³¨è§£ <a class="header-anchor" href="#answer-node-çš„ç±»å‹æ³¨è§£" aria-label="Permalink to &quot;answer_node çš„ç±»å‹æ³¨è§£&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> answer_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState) -&gt; OutputState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #             ^^^^^^^^^^^^^      ^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #             å¯ä»¥è®¿é—®æ‰€æœ‰å­—æ®µ    è¾“å‡ºä¼šè¢«è¿‡æ»¤</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>ä½œç”¨ï¼š</strong></p><ul><li><strong>è¾“å…¥</strong>ï¼šå¯ä»¥è®¿é—®å®Œæ•´çš„ <code>OverallState</code>ï¼ˆåŒ…æ‹¬ <code>notes</code>ï¼‰</li><li><strong>è¾“å‡º</strong>ï¼šè¿”å›å€¼ä¼šè¢«è¿‡æ»¤ï¼Œåªä¿ç•™ <code>OutputState</code> å®šä¹‰çš„å­—æ®µ</li></ul><p><strong>æ³¨æ„</strong>ï¼šå³ä½¿ <code>answer_node</code> è¿”å›äº† <code>notes</code>ï¼Œä¹Ÿä¼šè¢«è¿‡æ»¤æ‰ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> answer_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState) -&gt; OutputState:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye Lance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;notes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;some internal note&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # è¿™ä¸ªä¼šè¢«è¿‡æ»¤æ‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><h2 id="ğŸ“-æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“" tabindex="-1">ğŸ“ æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“ <a class="header-anchor" href="#ğŸ“-æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“" aria-label="Permalink to &quot;ğŸ“ æ ¸å¿ƒçŸ¥è¯†ç‚¹æ€»ç»“&quot;">â€‹</a></h2><h3 id="langgraph-ç‰¹æœ‰æ¦‚å¿µ" tabindex="-1">LangGraph ç‰¹æœ‰æ¦‚å¿µ <a class="header-anchor" href="#langgraph-ç‰¹æœ‰æ¦‚å¿µ" aria-label="Permalink to &quot;LangGraph ç‰¹æœ‰æ¦‚å¿µ&quot;">â€‹</a></h3><h4 id="_1-ç§æœ‰çŠ¶æ€-private-state" tabindex="-1">1. ç§æœ‰çŠ¶æ€ï¼ˆPrivate Stateï¼‰ <a class="header-anchor" href="#_1-ç§æœ‰çŠ¶æ€-private-state" aria-label="Permalink to &quot;1. ç§æœ‰çŠ¶æ€ï¼ˆPrivate Stateï¼‰&quot;">â€‹</a></h4><p><strong>å®šä¹‰ï¼š</strong> èŠ‚ç‚¹é—´ä¼ é€’ä½†ä¸å¯¹å¤–æš´éœ²çš„çŠ¶æ€</p><p><strong>å®ç°æ–¹å¼ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®šä¹‰ç§æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrivateState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    internal_data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŠ‚ç‚¹è¾“å‡ºç§æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PublicState) -&gt; PrivateState:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŠ‚ç‚¹æ¶ˆè´¹ç§æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; PublicState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ä½¿ç”¨ state[&quot;internal_data&quot;]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;processed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>å…³é”®ç‚¹ï¼š</strong></p><ul><li>ç§æœ‰å­—æ®µä¸ä¼šå‡ºç°åœ¨å›¾çš„æœ€ç»ˆè¾“å‡ºä¸­</li><li>åªåœ¨å›¾çš„å†…éƒ¨çŠ¶æ€ä¸­å­˜åœ¨</li><li>é€šè¿‡ç±»å‹æ³¨è§£æ§åˆ¶å¯è§æ€§</li></ul><h4 id="_2-è¾“å…¥-è¾“å‡ºæ¨¡å¼-input-output-schema" tabindex="-1">2. è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼ˆInput/Output Schemaï¼‰ <a class="header-anchor" href="#_2-è¾“å…¥-è¾“å‡ºæ¨¡å¼-input-output-schema" aria-label="Permalink to &quot;2. è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼ˆInput/Output Schemaï¼‰&quot;">â€‹</a></h4><p><strong>å®šä¹‰ï¼š</strong> é™å®šå›¾çš„è¾“å…¥å’Œè¾“å‡ºæ¥å£</p><p><strong>å®ç°æ–¹å¼ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    InternalState,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›¾å†…éƒ¨çš„å®Œæ•´çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    input_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InputState,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”¨æˆ·è¾“å…¥çš„çŠ¶æ€ç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    output_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OutputState </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿”å›ç»™ç”¨æˆ·çš„çŠ¶æ€ç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>ä¸‰ç§çŠ¶æ€çš„å…³ç³»ï¼š</strong></p><table tabindex="0"><thead><tr><th>çŠ¶æ€ç±»å‹</th><th>ç”¨é€”</th><th>å­—æ®µæ•°é‡</th><th>ä½œç”¨åŸŸ</th></tr></thead><tbody><tr><td>InputState</td><td>ç”¨æˆ·è¾“å…¥</td><td>æœ€å°‘ï¼ˆå¿…éœ€å­—æ®µï¼‰</td><td>å›¾å…¥å£</td></tr><tr><td>InternalState</td><td>å†…éƒ¨å¤„ç†</td><td>æœ€å¤šï¼ˆæ‰€æœ‰å­—æ®µï¼‰</td><td>å›¾å†…éƒ¨</td></tr><tr><td>OutputState</td><td>ç”¨æˆ·è¾“å‡º</td><td>é€‚ä¸­ï¼ˆæœ‰ç”¨å­—æ®µï¼‰</td><td>å›¾å‡ºå£</td></tr></tbody></table><p><strong>å…¸å‹æ¨¡å¼ï¼š</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>InputState âŠ† InternalState âŠ‡ OutputState</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="_3-çŠ¶æ€è¿‡æ»¤æœºåˆ¶" tabindex="-1">3. çŠ¶æ€è¿‡æ»¤æœºåˆ¶ <a class="header-anchor" href="#_3-çŠ¶æ€è¿‡æ»¤æœºåˆ¶" aria-label="Permalink to &quot;3. çŠ¶æ€è¿‡æ»¤æœºåˆ¶&quot;">â€‹</a></h4><p>LangGraph è‡ªåŠ¨è¿›è¡ŒçŠ¶æ€è¿‡æ»¤ï¼š</p><p><strong>è¾“å…¥è¿‡æ»¤ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç”¨æˆ·è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;extra&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ignored&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#                                ^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#                                ä¸åœ¨ InputState ä¸­ï¼Œè¢«å¿½ç•¥</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¦‚æœ InputState åªå®šä¹‰äº† questionï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆ™åªæœ‰ question ä¼šè¢«ä¼ å…¥å›¾</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>è¾“å‡ºè¿‡æ»¤ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å›¾çš„å†…éƒ¨çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">internal_state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;notes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;internal&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿”å›ç»™ç”¨æˆ·ï¼ˆåªä¿ç•™ OutputState å®šä¹‰çš„å­—æ®µï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">output </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bye&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># question å’Œ notes è¢«è¿‡æ»¤</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_4-èŠ‚ç‚¹ç±»å‹æ³¨è§£çš„å®Œæ•´è¯­æ³•" tabindex="-1">4. èŠ‚ç‚¹ç±»å‹æ³¨è§£çš„å®Œæ•´è¯­æ³• <a class="header-anchor" href="#_4-èŠ‚ç‚¹ç±»å‹æ³¨è§£çš„å®Œæ•´è¯­æ³•" aria-label="Permalink to &quot;4. èŠ‚ç‚¹ç±»å‹æ³¨è§£çš„å®Œæ•´è¯­æ³•&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InputType) -&gt; OutputType:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #        ^^^^^^^^^^^^^    ^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #        ä»å›¾çŠ¶æ€è¯»å–       å†™å›å›¾çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #        (è¿‡æ»¤è¾“å…¥)        (è¿‡æ»¤è¾“å‡º)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>ç±»å‹æ³¨è§£ç»„åˆï¼š</strong></p><table tabindex="0"><thead><tr><th>è¾“å…¥ç±»å‹</th><th>è¾“å‡ºç±»å‹</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>InputState</code></td><td><code>OutputState</code></td><td>è¯»å–æœ€å°è¾“å…¥ï¼Œå†™å…¥ç‰¹å®šè¾“å‡º</td></tr><tr><td><code>OverallState</code></td><td><code>PrivateState</code></td><td>è¯»å–æ‰€æœ‰å­—æ®µï¼Œå†™å…¥ç§æœ‰å­—æ®µ</td></tr><tr><td><code>PrivateState</code></td><td><code>OverallState</code></td><td>è¯»å–ç§æœ‰å­—æ®µï¼Œå†™å…¥å…¬å¼€å­—æ®µ</td></tr><tr><td><code>OverallState</code></td><td><code>OverallState</code></td><td>è¯»å†™å®Œæ•´çŠ¶æ€ï¼ˆé»˜è®¤ï¼‰</td></tr></tbody></table><hr><h3 id="python-ç‰¹æœ‰çŸ¥è¯†ç‚¹" tabindex="-1">Python ç‰¹æœ‰çŸ¥è¯†ç‚¹ <a class="header-anchor" href="#python-ç‰¹æœ‰çŸ¥è¯†ç‚¹" aria-label="Permalink to &quot;Python ç‰¹æœ‰çŸ¥è¯†ç‚¹&quot;">â€‹</a></h3><h4 id="_1-typeddict-è¯¦è§£" tabindex="-1">1. TypedDict è¯¦è§£ <a class="header-anchor" href="#_1-typeddict-è¯¦è§£" aria-label="Permalink to &quot;1. TypedDict è¯¦è§£&quot;">â€‹</a></h4><p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing_extensions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TypedDict</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Person</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    age: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">person: Person </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;age&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>ç‰¹æ€§ï¼š</strong></p><ul><li><strong>ç±»å‹æ£€æŸ¥</strong>ï¼šIDE ä¼šæç¤ºç±»å‹é”™è¯¯</li><li><strong>å­—å…¸æœ¬è´¨</strong>ï¼šä»ç„¶æ˜¯æ™®é€šå­—å…¸ï¼Œåªæ˜¯æ·»åŠ äº†ç±»å‹ä¿¡æ¯</li><li><strong>è¿è¡Œæ—¶</strong>ï¼šä¸ä¼šè¿›è¡Œä¸¥æ ¼éªŒè¯ï¼ˆä¸ Pydantic ä¸åŒï¼‰</li></ul><p><strong>å¯é€‰å­—æ®µï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NotRequired</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OptionalState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    required: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    optional: NotRequired[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯é€‰å­—æ®µ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆæ³•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state1: OptionalState </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;required&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state2: OptionalState </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;required&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;optional&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_2-ç±»å‹æ³¨è§£-type-hints" tabindex="-1">2. ç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰ <a class="header-anchor" href="#_2-ç±»å‹æ³¨è§£-type-hints" aria-label="Permalink to &quot;2. ç±»å‹æ³¨è§£ï¼ˆType Hintsï¼‰&quot;">â€‹</a></h4><p><strong>å‡½æ•°æ³¨è§£ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ^^^      ^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         å‚æ•°ç±»å‹  è¿”å›ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>å˜é‡æ³¨è§£ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">count: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">names: list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Bob&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data: dict[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>æ³›å‹æ³¨è§£ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> List, Dict, Optional, Union</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ—§å¼ï¼ˆPython 3.8ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">names: List[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapping: Dict[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">optional_value: Optional[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # int æˆ– None</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">union_value: Union[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # int æˆ– str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ–°å¼ï¼ˆPython 3.9+ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">names: list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Alice&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapping: dict[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">optional_value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> None</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">union_value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> str</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_3-annotated-ç±»å‹" tabindex="-1">3. Annotated ç±»å‹ <a class="header-anchor" href="#_3-annotated-ç±»å‹" aria-label="Permalink to &quot;3. Annotated ç±»å‹&quot;">â€‹</a></h4><p>åœ¨ LangGraph ä¸­å¸¸è§çš„ <code>Annotated</code> ç”¨æ³•ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> typing </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Annotated</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> State</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # åŸºç¡€ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # å¸¦ reducer çš„ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    messages: Annotated[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, operator.add]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #         ç±»å‹: list, åˆå¹¶ç­–ç•¥: operator.add</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Annotated çš„ç»“æ„ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Annotated[Type, metadata1, metadata2, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#         ^^^^  ^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#         å®é™…ç±»å‹    å…ƒæ•°æ®ï¼ˆé™„åŠ ä¿¡æ¯ï¼‰</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>LangGraph ä¸­çš„ç”¨é€”ï¼š</strong></p><ul><li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå®é™…çš„æ•°æ®ç±»å‹</li><li>ç¬¬äºŒä¸ªå‚æ•°ï¼šReducer å‡½æ•°ï¼ˆå¦‚ä½•åˆå¹¶å¤šä¸ªæ›´æ–°ï¼‰</li></ul><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¾‹å­ï¼šåˆ—è¡¨è¿½åŠ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">messages: Annotated[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, operator.add]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># node1 è¿”å› {&quot;messages&quot;: [&quot;a&quot;]}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># node2 è¿”å› {&quot;messages&quot;: [&quot;b&quot;]}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æœ€ç»ˆçŠ¶æ€: {&quot;messages&quot;: [&quot;a&quot;, &quot;b&quot;]}  â† operator.add è‡ªåŠ¨åˆå¹¶</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><h2 id="ğŸ’¡-æœ€ä½³å®è·µ" tabindex="-1">ğŸ’¡ æœ€ä½³å®è·µ <a class="header-anchor" href="#ğŸ’¡-æœ€ä½³å®è·µ" aria-label="Permalink to &quot;ğŸ’¡ æœ€ä½³å®è·µ&quot;">â€‹</a></h2><h3 id="_1-ä½•æ—¶ä½¿ç”¨ç§æœ‰çŠ¶æ€" tabindex="-1">1. ä½•æ—¶ä½¿ç”¨ç§æœ‰çŠ¶æ€ï¼Ÿ <a class="header-anchor" href="#_1-ä½•æ—¶ä½¿ç”¨ç§æœ‰çŠ¶æ€" aria-label="Permalink to &quot;1. ä½•æ—¶ä½¿ç”¨ç§æœ‰çŠ¶æ€ï¼Ÿ&quot;">â€‹</a></h3><p>âœ… <strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>å†…éƒ¨è®¡ç®—çš„ä¸­é—´ç»“æœï¼ˆå¦‚ä¸´æ—¶å˜é‡ã€ç¼“å­˜ï¼‰</li><li>è°ƒè¯•ä¿¡æ¯ï¼ˆå¦‚æ‰§è¡Œæ—¥å¿—ã€æ€§èƒ½æŒ‡æ ‡ï¼‰</li><li>æ•æ„Ÿä¿¡æ¯ï¼ˆä¸å¸Œæœ›æš´éœ²ç»™æœ€ç»ˆç”¨æˆ·ï¼‰</li><li>èŠ‚ç‚¹é—´çš„åè°ƒæ•°æ®ï¼ˆå¦‚è®¡æ•°å™¨ã€æ ‡å¿—ä½ï¼‰</li></ul><p>âŒ <strong>ä¸é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ç”¨æˆ·éœ€è¦çš„æ ¸å¿ƒæ•°æ®</li><li>éœ€è¦æŒä¹…åŒ–çš„ä¿¡æ¯</li><li>éœ€è¦åœ¨å¤šä¸ªå…¬å¼€èŠ‚ç‚¹é—´å…±äº«çš„æ•°æ®</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… å¥½çš„ç§æœ‰çŠ¶æ€ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrivateState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    processing_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # æ€§èƒ½ç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api_call_count: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # è°ƒè¯•ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    intermediate_result: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ä¸­é—´è®¡ç®—</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ ä¸åº”è¯¥ç§æœ‰çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrivateState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # ç”¨æˆ·éœ€è¦çŸ¥é“çš„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    final_result: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # æ ¸å¿ƒè¾“å‡ºæ•°æ®</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-ä½•æ—¶ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼" tabindex="-1">2. ä½•æ—¶ä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼Ÿ <a class="header-anchor" href="#_2-ä½•æ—¶ä½¿ç”¨è¾“å…¥-è¾“å‡ºæ¨¡å¼" aria-label="Permalink to &quot;2. ä½•æ—¶ä½¿ç”¨è¾“å…¥/è¾“å‡ºæ¨¡å¼ï¼Ÿ&quot;">â€‹</a></h3><p>âœ… <strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>API æœåŠ¡ï¼ˆéœ€è¦æ¸…æ™°çš„è¾“å…¥è¾“å‡ºæ¥å£ï¼‰</li><li>å¤šç§Ÿæˆ·ç³»ç»Ÿï¼ˆä¸åŒç”¨æˆ·çœ‹åˆ°ä¸åŒå­—æ®µï¼‰</li><li>å®‰å…¨æ•æ„Ÿåº”ç”¨ï¼ˆéšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼‰</li><li>å¤§å‹é¡¹ç›®ï¼ˆå¼ºåˆ¶æ¥å£è§„èŒƒï¼‰</li></ul><p>âŒ <strong>ä¸é€‚ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ç®€å•çš„å†…éƒ¨å·¥å…·</li><li>åŸå‹å¼€å‘é˜¶æ®µ</li><li>æ‰€æœ‰å­—æ®µéƒ½éœ€è¦è¾“å…¥è¾“å‡ºçš„æƒ…å†µ</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… å¥½çš„è¾“å…¥/è¾“å‡ºè®¾è®¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_query: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             # ç”¨æˆ·åªéœ€è¾“å…¥æŸ¥è¯¢</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # ç”¨æˆ·åªéœ€è¦ç­”æ¡ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    confidence: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # å’Œç½®ä¿¡åº¦</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InternalState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_query: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    confidence: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api_calls: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # å†…éƒ¨ç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cached: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # å†…éƒ¨æ ‡å¿—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    raw_response: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # åŸå§‹æ•°æ®</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3-çŠ¶æ€è®¾è®¡åŸåˆ™" tabindex="-1">3. çŠ¶æ€è®¾è®¡åŸåˆ™ <a class="header-anchor" href="#_3-çŠ¶æ€è®¾è®¡åŸåˆ™" aria-label="Permalink to &quot;3. çŠ¶æ€è®¾è®¡åŸåˆ™&quot;">â€‹</a></h3><h4 id="åŸåˆ™-1-æœ€å°åŒ–åŸåˆ™" tabindex="-1">åŸåˆ™ 1ï¼šæœ€å°åŒ–åŸåˆ™ <a class="header-anchor" href="#åŸåˆ™-1-æœ€å°åŒ–åŸåˆ™" aria-label="Permalink to &quot;åŸåˆ™ 1ï¼šæœ€å°åŒ–åŸåˆ™&quot;">â€‹</a></h4><p>æ¯ä¸ªçŠ¶æ€åªåŒ…å«å¿…éœ€çš„å­—æ®µï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… å¥½çš„è®¾è®¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">               # åªè¦å¿…éœ€å­—æ®µ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ è¿‡åº¦è®¾è®¡</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # è¾“å…¥ä¸éœ€è¦ answer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    notes: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # è¾“å…¥ä¸éœ€è¦ notes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    metadata: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # è¾“å…¥ä¸éœ€è¦ metadata</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="åŸåˆ™-2-å•ä¸€èŒè´£" tabindex="-1">åŸåˆ™ 2ï¼šå•ä¸€èŒè´£ <a class="header-anchor" href="#åŸåˆ™-2-å•ä¸€èŒè´£" aria-label="Permalink to &quot;åŸåˆ™ 2ï¼šå•ä¸€èŒè´£&quot;">â€‹</a></h4><p>æ¯ä¸ªçŠ¶æ€æœåŠ¡äºç‰¹å®šç›®çš„ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… å¥½çš„åˆ†ç¦»</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŒè´£ï¼šæ¥æ”¶ç”¨æˆ·è¾“å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ProcessingState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŒè´£ï¼šå†…éƒ¨å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    intermediate: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŒè´£ï¼šè¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ æ··æ·†èŒè´£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MixedState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ··åˆäº†æ‰€æœ‰èŒè´£</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # è¾“å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    intermediate: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # è¾“å‡º</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="åŸåˆ™-3-æ¸…æ™°çš„ç±»å‹æ³¨è§£" tabindex="-1">åŸåˆ™ 3ï¼šæ¸…æ™°çš„ç±»å‹æ³¨è§£ <a class="header-anchor" href="#åŸåˆ™-3-æ¸…æ™°çš„ç±»å‹æ³¨è§£" aria-label="Permalink to &quot;åŸåˆ™ 3ï¼šæ¸…æ™°çš„ç±»å‹æ³¨è§£&quot;">â€‹</a></h4><p>å§‹ç»ˆæ˜ç¡®æŒ‡å®šèŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºç±»å‹ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… æ¸…æ™°çš„ç±»å‹æ³¨è§£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InputState) -&gt; OutputState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ä¸€çœ¼å°±çŸ¥é“è¾“å…¥è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ ä¸æ¸…æ™°çš„æ³¨è§£</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ— æ³•çŸ¥é“ä½¿ç”¨å“ªä¸ªçŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr><h2 id="ğŸš€-è¿›é˜¶æŠ€å·§" tabindex="-1">ğŸš€ è¿›é˜¶æŠ€å·§ <a class="header-anchor" href="#ğŸš€-è¿›é˜¶æŠ€å·§" aria-label="Permalink to &quot;ğŸš€ è¿›é˜¶æŠ€å·§&quot;">â€‹</a></h2><h3 id="_1-éƒ¨åˆ†çŠ¶æ€æ›´æ–°" tabindex="-1">1. éƒ¨åˆ†çŠ¶æ€æ›´æ–° <a class="header-anchor" href="#_1-éƒ¨åˆ†çŠ¶æ€æ›´æ–°" aria-label="Permalink to &quot;1. éƒ¨åˆ†çŠ¶æ€æ›´æ–°&quot;">â€‹</a></h3><p>èŠ‚ç‚¹å¯ä»¥åªæ›´æ–°çŠ¶æ€çš„éƒ¨åˆ†å­—æ®µï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> State</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    a: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    b: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    c: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: State) -&gt; State:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # åªæ›´æ–° aï¼Œä¸å½±å“ b å’Œ c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;new_value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰§è¡Œå‰: {a: &quot;old&quot;, b: &quot;b&quot;, c: &quot;c&quot;}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰§è¡Œå: {a: &quot;new_value&quot;, b: &quot;b&quot;, c: &quot;c&quot;}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_2-çŠ¶æ€éªŒè¯" tabindex="-1">2. çŠ¶æ€éªŒè¯ <a class="header-anchor" href="#_2-çŠ¶æ€éªŒè¯" aria-label="Permalink to &quot;2. çŠ¶æ€éªŒè¯&quot;">â€‹</a></h3><p>ä½¿ç”¨ Pydantic è¿›è¡Œè¿è¡Œæ—¶éªŒè¯ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pydantic </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> BaseModel, validator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ValidatedInput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @validator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;question&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> question_not_empty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cls, v):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v.strip():</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            raise</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ValueError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Question cannot be empty&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åœ¨èŠ‚ç‚¹ä¸­ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # éªŒè¯è¾“å…¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    validated </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ValidatedInput(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ä½¿ç”¨ validated.question</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_3-åŠ¨æ€çŠ¶æ€é€‰æ‹©" tabindex="-1">3. åŠ¨æ€çŠ¶æ€é€‰æ‹© <a class="header-anchor" href="#_3-åŠ¨æ€çŠ¶æ€é€‰æ‹©" aria-label="Permalink to &quot;3. åŠ¨æ€çŠ¶æ€é€‰æ‹©&quot;">â€‹</a></h3><p>æ ¹æ®æ¡ä»¶é€‰æ‹©ä¸åŒçš„çŠ¶æ€ç»“æ„ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> conditional_node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: OverallState):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state.get(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;use_detailed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # è¿”å›è¯¦ç»†çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DetailedState(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # è¿”å›ç®€å•çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SimpleState(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-çŠ¶æ€ç»§æ‰¿" tabindex="-1">4. çŠ¶æ€ç»§æ‰¿ <a class="header-anchor" href="#_4-çŠ¶æ€ç»§æ‰¿" aria-label="Permalink to &quot;4. çŠ¶æ€ç»§æ‰¿&quot;">â€‹</a></h3><p>å¤ç”¨çŠ¶æ€å®šä¹‰ï¼š</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BaseState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    timestamp: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ProcessingState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç»§æ‰¿ BaseState</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ProcessingState è‡ªåŠ¨åŒ…å« timestamp å’Œ user_id</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr><h2 id="ğŸ“Š-çŠ¶æ€æ¨¡å¼å¯¹æ¯”" tabindex="-1">ğŸ“Š çŠ¶æ€æ¨¡å¼å¯¹æ¯” <a class="header-anchor" href="#ğŸ“Š-çŠ¶æ€æ¨¡å¼å¯¹æ¯”" aria-label="Permalink to &quot;ğŸ“Š çŠ¶æ€æ¨¡å¼å¯¹æ¯”&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>å•ä¸€çŠ¶æ€</th><th>ç§æœ‰çŠ¶æ€</th><th>è¾“å…¥/è¾“å‡ºæ¨¡å¼</th></tr></thead><tbody><tr><td><strong>å¤æ‚åº¦</strong></td><td>ä½</td><td>ä¸­</td><td>é«˜</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>ä½</td><td>ä¸­</td><td>é«˜</td></tr><tr><td><strong>å°è£…æ€§</strong></td><td>å·®</td><td>å¥½</td><td>æœ€å¥½</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å•å›¾</td><td>å†…éƒ¨è®¡ç®—</td><td>APIã€æœåŠ¡</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>å¹³ç¼“</td><td>é€‚ä¸­</td><td>é™¡å³­</td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç®€å•åŸå‹ â†’ å•ä¸€çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(SimpleState)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># éœ€è¦éšè—ä¸­é—´æ•°æ® â†’ ç§æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PublicState) -&gt; PrivateState: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; PublicState: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯¹å¤–æœåŠ¡ â†’ è¾“å…¥/è¾“å‡ºæ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    InternalState,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    input_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InputState,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    output_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OutputState</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr><h2 id="ğŸ¯-å®é™…åº”ç”¨æ¡ˆä¾‹" tabindex="-1">ğŸ¯ å®é™…åº”ç”¨æ¡ˆä¾‹ <a class="header-anchor" href="#ğŸ¯-å®é™…åº”ç”¨æ¡ˆä¾‹" aria-label="Permalink to &quot;ğŸ¯ å®é™…åº”ç”¨æ¡ˆä¾‹&quot;">â€‹</a></h2><h3 id="æ¡ˆä¾‹-1-æ™ºèƒ½å®¢æœç³»ç»Ÿ" tabindex="-1">æ¡ˆä¾‹ 1ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ <a class="header-anchor" href="#æ¡ˆä¾‹-1-æ™ºèƒ½å®¢æœç³»ç»Ÿ" aria-label="Permalink to &quot;æ¡ˆä¾‹ 1ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å…¥ï¼šç”¨æˆ·åªéœ€æä¾›é—®é¢˜</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡ºï¼šè¿”å›ç­”æ¡ˆå’Œç½®ä¿¡åº¦</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OutputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    confidence: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†…éƒ¨ï¼šåŒ…å«æ‰€æœ‰å¤„ç†ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InternalState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    confidence: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    retrieved_docs: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # æ£€ç´¢çš„æ–‡æ¡£ï¼ˆç§æœ‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api_response: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dict</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # API åŸå§‹å“åº”ï¼ˆç§æœ‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    processing_time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # å¤„ç†æ—¶é—´ï¼ˆç§æœ‰ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> retrieve_docs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InputState) -&gt; InternalState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # æ£€ç´¢ç›¸å…³æ–‡æ¡£</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    docs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vector_db.search(state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;retrieved_docs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: docs}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> generate_answer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InternalState) -&gt; OutputState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç”Ÿæˆç­”æ¡ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> llm.invoke({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_question&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;context&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;retrieved_docs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;answer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: response.answer,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;confidence&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: response.confidence</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> StateGraph(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    InternalState,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    input_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InputState,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    output_schema</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OutputState</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="æ¡ˆä¾‹-2-æ•°æ®å¤„ç†ç®¡é“" tabindex="-1">æ¡ˆä¾‹ 2ï¼šæ•°æ®å¤„ç†ç®¡é“ <a class="header-anchor" href="#æ¡ˆä¾‹-2-æ•°æ®å¤„ç†ç®¡é“" aria-label="Permalink to &quot;æ¡ˆä¾‹ 2ï¼šæ•°æ®å¤„ç†ç®¡é“&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç§æœ‰çŠ¶æ€ï¼šä¸­é—´å¤„ç†æ­¥éª¤</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrivateState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cleaned_data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    validation_result: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å…¬å¼€çŠ¶æ€ï¼šè¾“å…¥å’Œè¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PublicState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    raw_data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    processed_data: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> clean_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PublicState) -&gt; PrivateState:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cleaned </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;raw_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].strip().lower()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    is_valid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cleaned) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;cleaned_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: cleaned,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;validation_result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: is_valid</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> process_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: PrivateState) -&gt; PublicState:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;validation_result&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        processed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cleaned_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].upper()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;processed_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: processed}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;processed_data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cleaned_data å’Œ validation_result ä¸ä¼šå‡ºç°åœ¨æœ€ç»ˆè¾“å‡º</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="æ¡ˆä¾‹-3-å¤šé˜¶æ®µè®¤è¯ç³»ç»Ÿ" tabindex="-1">æ¡ˆä¾‹ 3ï¼šå¤šé˜¶æ®µè®¤è¯ç³»ç»Ÿ <a class="header-anchor" href="#æ¡ˆä¾‹-3-å¤šé˜¶æ®µè®¤è¯ç³»ç»Ÿ" aria-label="Permalink to &quot;æ¡ˆä¾‹ 3ï¼šå¤šé˜¶æ®µè®¤è¯ç³»ç»Ÿ&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LoginInput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    username: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    password: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SessionState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ç§æœ‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    permissions: list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    session_token: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LoginOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    session_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # ä¸æš´éœ²å®Œæ•´ token</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InternalState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    username: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    password: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    permissions: list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    session_token: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    success: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    session_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> authenticate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: LoginInput) -&gt; SessionState:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # éªŒè¯ç”¨æˆ·å¹¶åˆ›å»ºä¼šè¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.authenticate(state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: user.id,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;permissions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: user.permissions,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;session_token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: generate_token(user.id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: InternalState) -&gt; LoginOutput:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # åˆ›å»ºå®‰å…¨çš„å“åº”ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;session_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hash</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;session_token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># session_token å’Œ user_id ä¸ä¼šæš´éœ²ç»™å®¢æˆ·ç«¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><hr><h2 id="ğŸ”-å¸¸è§é—®é¢˜" tabindex="-1">ğŸ” å¸¸è§é—®é¢˜ <a class="header-anchor" href="#ğŸ”-å¸¸è§é—®é¢˜" aria-label="Permalink to &quot;ğŸ” å¸¸è§é—®é¢˜&quot;">â€‹</a></h2><h3 id="q1-ç§æœ‰çŠ¶æ€çš„æ•°æ®ä¼šè¢«å®Œå…¨åˆ é™¤å—" tabindex="-1">Q1: ç§æœ‰çŠ¶æ€çš„æ•°æ®ä¼šè¢«å®Œå…¨åˆ é™¤å—ï¼Ÿ <a class="header-anchor" href="#q1-ç§æœ‰çŠ¶æ€çš„æ•°æ®ä¼šè¢«å®Œå…¨åˆ é™¤å—" aria-label="Permalink to &quot;Q1: ç§æœ‰çŠ¶æ€çš„æ•°æ®ä¼šè¢«å®Œå…¨åˆ é™¤å—ï¼Ÿ&quot;">â€‹</a></h3><p><strong>ç­”ï¼š</strong> ä¸ä¼šã€‚ç§æœ‰çŠ¶æ€çš„æ•°æ®åœ¨å›¾çš„å†…éƒ¨çŠ¶æ€ä¸­ä»ç„¶å­˜åœ¨ï¼Œåªæ˜¯åœ¨æœ€ç»ˆè¾“å‡ºæ—¶è¢«è¿‡æ»¤æ‰ã€‚</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†…éƒ¨çŠ¶æ€ï¼ˆæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">internal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;baz&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # â† ä»ç„¶å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¾“å‡ºçŠ¶æ€ï¼ˆè¿”å›ç»™ç”¨æˆ·ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">output </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # â† baz è¢«è¿‡æ»¤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>è®¿é—®å†…éƒ¨çŠ¶æ€ï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ stream æŸ¥çœ‹å®Œæ•´çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.stream({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ä»¥çœ‹åˆ° baz</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨ invoke åªèƒ½çœ‹åˆ°è¿‡æ»¤åçš„çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> graph.invoke({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;foo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># çœ‹ä¸åˆ° baz</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="q2-èŠ‚ç‚¹çš„è¿”å›å€¼ä¼šè¦†ç›–è¿˜æ˜¯åˆå¹¶çŠ¶æ€" tabindex="-1">Q2: èŠ‚ç‚¹çš„è¿”å›å€¼ä¼šè¦†ç›–è¿˜æ˜¯åˆå¹¶çŠ¶æ€ï¼Ÿ <a class="header-anchor" href="#q2-èŠ‚ç‚¹çš„è¿”å›å€¼ä¼šè¦†ç›–è¿˜æ˜¯åˆå¹¶çŠ¶æ€" aria-label="Permalink to &quot;Q2: èŠ‚ç‚¹çš„è¿”å›å€¼ä¼šè¦†ç›–è¿˜æ˜¯åˆå¹¶çŠ¶æ€ï¼Ÿ&quot;">â€‹</a></h3><p><strong>ç­”ï¼š</strong> é»˜è®¤æ˜¯<strong>åˆå¹¶</strong>ï¼ˆmergeï¼‰ï¼Œä¸æ˜¯è¦†ç›–ï¼ˆreplaceï¼‰ã€‚</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åˆå§‹çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;c&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># èŠ‚ç‚¹è¿”å›</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># åªæ›´æ–° a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ‰§è¡Œåçš„çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;c&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># b å’Œ c ä¿æŒä¸å˜</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>é™¤éä½¿ç”¨ Reducerï¼š</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨è‡ªå®šä¹‰ reducer</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> State</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data: Annotated[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, my_custom_reducer]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯ä»¥å®ç°è¦†ç›–ã€è¿½åŠ ã€åˆå¹¶ç­‰ä»»ä½•é€»è¾‘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="q3-å¯ä»¥åœ¨ä¸åŒèŠ‚ç‚¹é—´åˆ‡æ¢çŠ¶æ€ç±»å‹å—" tabindex="-1">Q3: å¯ä»¥åœ¨ä¸åŒèŠ‚ç‚¹é—´åˆ‡æ¢çŠ¶æ€ç±»å‹å—ï¼Ÿ <a class="header-anchor" href="#q3-å¯ä»¥åœ¨ä¸åŒèŠ‚ç‚¹é—´åˆ‡æ¢çŠ¶æ€ç±»å‹å—" aria-label="Permalink to &quot;Q3: å¯ä»¥åœ¨ä¸åŒèŠ‚ç‚¹é—´åˆ‡æ¢çŠ¶æ€ç±»å‹å—ï¼Ÿ&quot;">â€‹</a></h3><p><strong>ç­”ï¼š</strong> å¯ä»¥ï¼è¿™æ­£æ˜¯ Multiple Schemas çš„æ ¸å¿ƒåŠŸèƒ½ã€‚</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: StateA) -&gt; StateB:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è¾“å…¥ StateAï¼Œè¾“å‡º StateB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: StateB) -&gt; StateC:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è¾“å…¥ StateBï¼Œè¾“å‡º StateC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state: StateC) -&gt; StateA:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # è¾“å…¥ StateCï¼Œè¾“å‡º StateAï¼ˆå›åˆ°èµ·ç‚¹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>é™åˆ¶ï¼š</strong> æ‰€æœ‰çŠ¶æ€ç±»å‹çš„å­—æ®µå¿…é¡»èƒ½å¤Ÿåˆå¹¶åˆ°å›¾çš„ä¸»çŠ¶æ€ç±»å‹ä¸­ã€‚</p><h3 id="q4-inputstate-å¯ä»¥åŒ…å«-overallstate-æ²¡æœ‰çš„å­—æ®µå—" tabindex="-1">Q4: InputState å¯ä»¥åŒ…å« OverallState æ²¡æœ‰çš„å­—æ®µå—ï¼Ÿ <a class="header-anchor" href="#q4-inputstate-å¯ä»¥åŒ…å«-overallstate-æ²¡æœ‰çš„å­—æ®µå—" aria-label="Permalink to &quot;Q4: InputState å¯ä»¥åŒ…å« OverallState æ²¡æœ‰çš„å­—æ®µå—ï¼Ÿ&quot;">â€‹</a></h3><p><strong>ç­”ï¼š</strong> ä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºè¿™äº›å­—æ®µæ— æ³•è¢«å­˜å‚¨åˆ°å›¾çŠ¶æ€ä¸­ã€‚</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ ä¸æ¨è</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InputState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    extra_field: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # OverallState æ²¡æœ‰è¿™ä¸ªå­—æ®µ</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> OverallState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TypedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    question: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    answer: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ç¼ºå°‘ extra_field</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å½“ç”¨æˆ·è¾“å…¥ {&quot;question&quot;: &quot;hi&quot;, &quot;extra_field&quot;: &quot;value&quot;}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># extra_field ä¼šè¢«å¿½ç•¥æˆ–å¯¼è‡´é”™è¯¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>æ­£ç¡®åšæ³•ï¼š</strong> InputState åº”è¯¥æ˜¯ OverallState çš„å­é›†ã€‚</p><hr><h2 id="ğŸ“–-æ‰©å±•é˜…è¯»" tabindex="-1">ğŸ“– æ‰©å±•é˜…è¯» <a class="header-anchor" href="#ğŸ“–-æ‰©å±•é˜…è¯»" aria-label="Permalink to &quot;ğŸ“– æ‰©å±•é˜…è¯»&quot;">â€‹</a></h2><ul><li><a href="https://langchain-ai.github.io/langgraph/how-tos/pass_private_state/" target="_blank" rel="noreferrer">LangGraph Private State å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://langchain-ai.github.io/langgraph/how-tos/input_output_schema/" target="_blank" rel="noreferrer">LangGraph Input/Output Schema å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://docs.python.org/3/library/typing.html#typing.TypedDict" target="_blank" rel="noreferrer">Python TypedDict æ–‡æ¡£</a></li><li><a href="https://peps.python.org/pep-0484/" target="_blank" rel="noreferrer">Python Type Hints PEP 484</a></li></ul><hr><h2 id="ğŸ-æ€»ç»“" tabindex="-1">ğŸ æ€»ç»“ <a class="header-anchor" href="#ğŸ-æ€»ç»“" aria-label="Permalink to &quot;ğŸ æ€»ç»“&quot;">â€‹</a></h2><p><strong>Multiple Schemasï¼ˆå¤šçŠ¶æ€æ¨¡å¼ï¼‰</strong> æ˜¯ LangGraph ä¸­çš„é«˜çº§ç‰¹æ€§ï¼Œæä¾›äº†ä¸‰ç§å¼ºå¤§çš„èƒ½åŠ›ï¼š</p><ol><li><p><strong>ç§æœ‰çŠ¶æ€ï¼ˆPrivate Stateï¼‰</strong></p><ul><li>èŠ‚ç‚¹é—´ä¼ é€’ç§æœ‰æ•°æ®</li><li>éšè—å†…éƒ¨å®ç°ç»†èŠ‚</li><li>ä¿æŒè¾“å‡ºç®€æ´</li></ul></li><li><p><strong>è¾“å…¥æ¨¡å¼ï¼ˆInput Schemaï¼‰</strong></p><ul><li>é™å®šç”¨æˆ·è¾“å…¥</li><li>æé«˜å®‰å…¨æ€§</li><li>å¼ºåˆ¶æ¥å£è§„èŒƒ</li></ul></li><li><p><strong>è¾“å‡ºæ¨¡å¼ï¼ˆOutput Schemaï¼‰</strong></p><ul><li>è¿‡æ»¤è¾“å‡ºå­—æ®µ</li><li>ä¿æŠ¤æ•æ„Ÿä¿¡æ¯</li><li>æä¾›æ¸…æ™°çš„ API</li></ul></li></ol><p><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong></p><ul><li><strong>æ›´å¥½çš„å°è£…</strong>ï¼šéšè—å†…éƒ¨ç»†èŠ‚</li><li><strong>æ›´æ¸…æ™°çš„æ¥å£</strong>ï¼šæ˜ç¡®çš„è¾“å…¥è¾“å‡º</li><li><strong>æ›´é«˜çš„å®‰å…¨æ€§</strong>ï¼šé˜²æ­¢æ•°æ®æ³„éœ²</li><li><strong>æ›´å¼ºçš„å¯ç»´æŠ¤æ€§</strong>ï¼šä»£ç ç»“æ„æ¸…æ™°</li></ul><p>æŒæ¡ Multiple Schemasï¼Œä½ å°±èƒ½æ„å»ºå‡ºæ›´åŠ ä¸“ä¸šã€å®‰å…¨ã€æ˜“ç”¨çš„ LangGraph åº”ç”¨ï¼</p>`,222)])])}const g=a(p,[["render",e]]);export{c as __pageData,g as default};
